import{w as I,a as n,p as e}from"./chunk-B7RQU5TL-mf8dp6A9.js";import{u as D}from"./FlowiseAgentsContext-CLOlgCO7.js";import{u as q}from"./PromptsContext-6ZfF2ThP.js";import{P as G}from"./PageHeader-DKlfP6W3.js";import"./UIContext-BM-qYgXm.js";function V({}){return[{title:"Flowise Agents - AI Agent Testing"},{name:"description",content:"Plataforma para probar y experimentar con agentes de Flowise AI"}]}const K=I(function(){const{agents:p,isLoading:E}=D(),{prompts:x}=q(),[d,A]=n.useState(""),[j,v]=n.useState(""),[m,u]=n.useState(""),[c,w]=n.useState(!1),[N,h]=n.useState(null),[b,y]=n.useState(null),[l,f]=n.useState([]),[k,C]=n.useState(null),F=r=>{const s=["image/jpeg","image/jpg","image/png","image/gif","image/bmp","image/webp"],a=[],o=[];return r.forEach(i=>{if(!s.includes(i.type)){o.push(`${i.name}: Tipo no soportado (${i.type||"desconocido"})`);return}if(i.size>10485760){o.push(`${i.name}: Excede 10MB`);return}a.push(i)}),{validFiles:a,errors:o}},P=r=>{const s=Array.from(r),{validFiles:t,errors:a}=F(s);C(a.length>0?`Algunos archivos fueron rechazados:
${a.join(`
`)}`:null),t.length>0&&f(o=>[...o,...t])},L=r=>{f(s=>s.filter((t,a)=>a!==r))},S=()=>{f([]),C(null)},z=r=>new Promise((s,t)=>{const a=new FileReader;a.onload=()=>{const o=a.result;typeof o=="string"?s(o):t(new Error("No se pudo leer el archivo"))},a.onerror=()=>t(a.error||new Error("Error leyendo el archivo")),a.readAsDataURL(r)});n.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("prompt");s&&u(s)},[]);const M=async r=>{if(r.preventDefault(),!d||!m.trim())return;const s=p.find(t=>t.id===d);if(s){w(!0),y(null),h(null);try{let t;if(l.length>0){const i=await Promise.all(l.map(g=>z(g)));t=l.map((g,B)=>({type:"file",name:g.name,mime:g.type,data:i[B]}))}const a=await fetch(s.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t&&t.length>0?{question:m.trim(),uploads:t}:{question:m.trim()})});if(!a.ok)throw new Error(`Error ${a.status}: ${a.statusText}`);const o=await a.json();h(o)}catch(t){y(t instanceof Error?t.message:"Error desconocido")}finally{w(!1)}}},R=()=>{u(""),h(null),y(null),S()},T=r=>{const s=x.find(t=>t.id===r);s&&(u(s.content),v(r))},$=()=>{v(""),u("")};return e.jsxs("div",{className:"min-h-screen pb-20",style:{backgroundColor:"var(--color-background)"},children:[e.jsx(G,{title:"Flowise Agents",description:"Plataforma para probar y experimentar con agentes de IA",icon:"ðŸ¤–"}),e.jsx("div",{className:"p-4",children:E?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Cargando agentes..."})}):p.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--color-accent)"},children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),e.jsx("h2",{className:"text-lg font-semibold mb-2",style:{color:"var(--color-text-primary)"},children:"No hay agentes configurados"}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--color-text-secondary)"},children:"Ve a ConfiguraciÃ³n para agregar tu primer agente de Flowise"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsx("button",{onClick:()=>window.location.href="/settings",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors duration-200",children:"Ir a ConfiguraciÃ³n"}),x.length>0&&e.jsx("button",{onClick:()=>window.location.href="/prompts",className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200",children:"Gestionar Prompts"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Seleccionar Agente"}),e.jsxs("select",{value:d,onChange:r=>A(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Selecciona un agente..."}),p.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),d&&x.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",style:{color:"var(--color-text-primary)"},children:"Seleccionar Prompt"}),e.jsx("button",{onClick:()=>window.location.href="/prompts",className:"text-xs text-blue-600 hover:text-blue-700 underline",children:"Gestionar Prompts"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:j,onChange:r=>T(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Selecciona un prompt..."}),x.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),j&&e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:$,className:"text-xs text-gray-600 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 underline",children:"Escribir pregunta personalizada"})})]})]}),d&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Pregunta"}),e.jsx("textarea",{value:m,onChange:r=>u(r.target.value),placeholder:"Escribe tu pregunta aquÃ­...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Adjuntar ImÃ¡genes (opcional)"}),e.jsxs("div",{className:`border-2 border-dashed rounded-md p-4 text-center ${c?"opacity-50 cursor-not-allowed":"cursor-pointer hover:border-blue-400 dark:hover:border-blue-500"} border-gray-300 dark:border-gray-600`,onDragOver:r=>{r.preventDefault(),r.stopPropagation()},onDrop:r=>{r.preventDefault(),r.stopPropagation(),!c&&r.dataTransfer.files&&P(r.dataTransfer.files)},onClick:()=>{if(!c){const r=document.getElementById("flowise-images-input");r==null||r.click()}},children:[e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Arrastra imÃ¡genes aquÃ­ o haz clic para seleccionar"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-secondary)"},children:"Tipos: JPG, PNG, GIF, BMP, WebP. MÃ¡x 10MB por archivo."}),e.jsx("input",{id:"flowise-images-input",type:"file",accept:"image/*",multiple:!0,className:"hidden",disabled:c,onChange:r=>{r.target.files&&(P(r.target.files),r.target.value="")}})]}),k&&e.jsx("div",{className:"mt-2 p-2 text-xs rounded-md",style:{backgroundColor:"rgba(220,38,38,0.1)",color:"#fca5a5"},children:k}),l.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",style:{color:"var(--color-text-primary)"},children:[l.length," imagen",l.length!==1?"es":""," seleccionada",l.length!==1?"s":""]}),e.jsx("button",{type:"button",onClick:S,className:"text-xs text-red-600 hover:text-red-700",children:"Limpiar imÃ¡genes"})]}),e.jsx("ul",{className:"text-xs space-y-1",style:{color:"var(--color-text-secondary)"},children:l.map((r,s)=>e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"truncate mr-2",children:[r.name," (",Math.round(r.size/1024)," KB)"]}),e.jsx("button",{type:"button",onClick:()=>L(s),className:"text-red-600 hover:text-red-700","aria-label":`Eliminar ${r.name}`,children:"âœ•"})]},`${r.name}-${s}`))})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",disabled:!m.trim()||c,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-md transition-colors duration-200 flex items-center justify-center",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enviando..."]}):"Enviar Pregunta"}),e.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200",children:"Limpiar"})]})]})}),(N||b)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",style:{color:"var(--color-text-primary)"},children:"Respuesta"}),b?e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200 font-medium",children:"Error"})]}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:b})]}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm text-green-800 dark:text-green-200 font-medium",children:"Respuesta exitosa"})]}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-300 whitespace-pre-wrap overflow-x-auto",children:JSON.stringify(N,null,2)})]})})]})]})})]})});export{K as default,V as meta};
