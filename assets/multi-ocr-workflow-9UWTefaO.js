var we=Object.defineProperty;var Ne=(x,r,n)=>r in x?we(x,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):x[r]=n;var I=(x,r,n)=>Ne(x,typeof r!="symbol"?r+"":r,n);import{a as p,p as e,w as ke}from"./chunk-B7RQU5TL-xj-QjgGV.js";import{u as Ce}from"./MultiOCRWorkflowContext-DmgecTKq.js";import{u as z}from"./FlowiseAgentsContext-DaThIt2D.js";import{u as Se}from"./MathpixSettingsContext-C5kfmVKl.js";import{u as Te}from"./PromptsContext-klJWnLUU.js";import{M as te}from"./mathpixService-DfuBcCPs.js";import{W as se}from"./react-webcam-Cv0vQhem.js";import{u as oe}from"./CameraSettingsContext-BDn7_6_x.js";import{u as ne}from"./UIContext-ou41-CYt.js";import{P as Ee}from"./PageHeader-Bi621ECd.js";class R{static async processWorkflow(r,n,s,o,t){var u,l,c,a,d,v,h,f,b,C,g,N,i,m,j;try{(u=t==null?void 0:t.onStepStart)==null||u.call(t,"ocr-processing"),(l=t==null?void 0:t.onProgress)==null||l.call(t,1,4,"Procesando OCR de imÃ¡genes...");const k=await this.processImagesOCR(r,o,t);if(k.some(M=>M.error)){const M="Error en procesamiento OCR de algunas imÃ¡genes";throw(c=t==null?void 0:t.onStepError)==null||c.call(t,"ocr-processing",M),new Error(M)}(a=t==null?void 0:t.onStepComplete)==null||a.call(t,"ocr-processing",k),(d=t==null?void 0:t.onStepStart)==null||d.call(t,"ocr-compilation"),(v=t==null?void 0:t.onProgress)==null||v.call(t,2,4,"Compilando resultados OCR...");const E=this.compileOCRResults(k);(h=t==null?void 0:t.onStepComplete)==null||h.call(t,"ocr-compilation",{compiledText:E}),(f=t==null?void 0:t.onStepStart)==null||f.call(t,"question-compiler"),(b=t==null?void 0:t.onProgress)==null||b.call(t,3,4,"Procesando con agente compilador...");const L=await this.callFlowiseAgent(n,E);if(L.error)throw(C=t==null?void 0:t.onStepError)==null||C.call(t,"question-compiler",L.error),new Error(`Error en agente compilador: ${L.error}`);(g=t==null?void 0:t.onStepComplete)==null||g.call(t,"question-compiler",L),(N=t==null?void 0:t.onStepStart)==null||N.call(t,"response-agents"),(i=t==null?void 0:t.onProgress)==null||i.call(t,4,4,"Procesando con agentes de respuesta...");const W=await this.processResponseAgents(s,L.data,t);return Object.values(W).some(M=>M.error)&&((m=t==null?void 0:t.onStepError)==null||m.call(t,"response-agents","Error en algunos agentes de respuesta")),(j=t==null?void 0:t.onStepComplete)==null||j.call(t,"response-agents",W),{compiledOCRText:E,questionCompilerResult:L,responseAgentsResults:W,success:!0}}catch(k){return console.error("Error in MultiOCR Workflow:",k),{compiledOCRText:"",questionCompilerResult:null,responseAgentsResults:{},success:!1,error:k instanceof Error?k.message:"Error desconocido"}}}static async processImagesOCR(r,n,s){const o=r.map(async t=>{var u,l,c,a;try{(u=s==null?void 0:s.onImageOCRStart)==null||u.call(s,t.id);const d=await te.processImage(t.file,n);return d.error?((l=s==null?void 0:s.onImageOCRError)==null||l.call(s,t.id,d.error),{imageId:t.id,result:null,error:d.error}):((c=s==null?void 0:s.onImageOCRComplete)==null||c.call(s,t.id,d),{imageId:t.id,result:d})}catch(d){const v=d instanceof Error?d.message:"Error desconocido";return(a=s==null?void 0:s.onImageOCRError)==null||a.call(s,t.id,v),{imageId:t.id,result:null,error:v}}});return Promise.all(o)}static compileOCRResults(r){let n="";return r.forEach((s,o)=>{if(s.result&&!s.error){const t=o+1;let u="";s.result.data&&(typeof s.result.data=="string"?u=s.result.data:s.result.data.text?u=s.result.data.text:s.result.data.latex?u=s.result.data.latex:u=JSON.stringify(s.result.data)),n+=`OCR #${t} ${u} FIN OCR #${t}

`}}),n.trim()}static async callFlowiseAgent(r,n){try{const s=await fetch(r.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n.trim()})});if(!s.ok)throw new Error(`Error ${s.status}: ${s.statusText}`);return{data:await s.json()}}catch(s){return{data:null,error:s instanceof Error?s.message:"Error desconocido"}}}static async processResponseAgents(r,n,s){let o="";typeof n=="string"?o=n:n!=null&&n.text?o=n.text:o=JSON.stringify(n);const t=r.map(async c=>{try{const a=await this.callFlowiseAgent(c,o);return{agentId:c.id,result:a}}catch(a){return{agentId:c.id,result:{data:null,error:a instanceof Error?a.message:"Error desconocido"}}}}),u=await Promise.all(t),l={};return u.forEach(({agentId:c,result:a})=>{l[c]=a}),l}static formatOCRResult(r){return!r||!r.data?"Sin resultado":typeof r.data=="string"?r.data:r.data.text?r.data.text:r.data.latex?r.data.latex:JSON.stringify(r.data,null,2)}static formatAgentResult(r){var n;if(!r)return"Sin resultado";if(r.error)return`Error: ${r.error}`;if(r.data){if(r.data.lectura)return console.log("TTS: Encontrado campo lectura en data.lectura:",r.data.lectura),r.data.lectura;if(typeof r.data=="string")return r.data;if(typeof r.data=="object"){const s=t=>{if(t.lectura&&typeof t.lectura=="string")return t.lectura;for(const u in t)if(typeof t[u]=="object"&&t[u]!==null){const l=s(t[u]);if(l)return l}return null},o=s(r.data);if(o)return console.log("TTS: Encontrado campo lectura recursivamente:",o),o}}return r.lectura&&typeof r.lectura=="string"?(console.log("TTS: Encontrado campo lectura en nivel raÃ­z:",r.lectura),r.lectura):(n=r.data)!=null&&n.text?r.data.text:(console.log("TTS: No se encontrÃ³ campo lectura, devolviendo JSON completo:",r.data),JSON.stringify(r.data,null,2))}static async processDirectAgents(r,n,s,o){var t,u,l;try{(t=o==null?void 0:o.onStepStart)==null||t.call(o,"direct-agents"),(u=o==null?void 0:o.onProgress)==null||u.call(o,1,1,"Procesando con agentes directos...");const c=await this.convertImagesToUploads(r),a=await this.processDirectAgentsParallel(n,s.content,c,o);return(l=o==null?void 0:o.onStepComplete)==null||l.call(o,"direct-agents",a),{directAgentsResults:a,success:!0}}catch(c){return console.error("Error in Direct Agents Workflow:",c),{directAgentsResults:{},success:!1,error:c instanceof Error?c.message:"Error desconocido"}}}static async convertImagesToUploads(r){const n=[];for(const s of r)try{const o=await this.fileToDataURL(s.file);n.push({type:"file",name:s.name,mime:s.file.type,data:o})}catch(o){console.error(`Error converting image ${s.name} to Data URL:`,o)}return n}static fileToDataURL(r){return new Promise((n,s)=>{const o=new FileReader;o.onload=()=>{const t=o.result;typeof t=="string"?n(t):s(new Error("No se pudo leer el archivo"))},o.onerror=()=>s(o.error||new Error("Error leyendo el archivo")),o.readAsDataURL(r)})}static async processDirectAgentsParallel(r,n,s,o){const t=r.map(async c=>{try{const a=await this.callFlowiseAgentWithUploads(c,n,s);return{agentId:c.id,result:a}}catch(a){return{agentId:c.id,result:{data:null,error:a instanceof Error?a.message:"Error desconocido"}}}}),u=await Promise.all(t),l={};return u.forEach(({agentId:c,result:a})=>{l[c]=a}),l}static async callFlowiseAgentWithUploads(r,n,s){try{const o=await fetch(r.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n.trim(),uploads:s})});if(!o.ok)throw new Error(`Error ${o.status}: ${o.statusText}`);return{data:await o.json()}}catch(o){return{data:null,error:o instanceof Error?o.message:"Error desconocido"}}}}class Le{constructor(){I(this,"queue",[]);I(this,"isPlaying",!1);I(this,"currentUtterance",null);I(this,"isEnabled",!1);"speechSynthesis"in window||console.warn("Speech synthesis no estÃ¡ soportado en este navegador")}setEnabled(r){this.isEnabled=r,r||this.stop()}addToQueue(r){if(!this.isEnabled)return;const n={...r,id:`tts-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};this.queue.push(n),console.log(`TTS: Agregado a la cola - ${n.agentName}`,n.text.substring(0,100)+"..."),this.isPlaying||this.processQueue()}async processQueue(){var n,s;if(this.queue.length===0||this.isPlaying)return;const r=this.queue.shift();if(r){this.isPlaying=!0,console.log(`TTS: Iniciando lectura - ${r.agentName}`);try{await this.speak(r)}catch(o){console.error("TTS: Error en la lectura:",o),(n=r.onError)==null||n.call(r,o)}finally{this.isPlaying=!1,(s=r.onEnd)==null||s.call(r),setTimeout(()=>this.processQueue(),100)}}}speak(r){return new Promise((n,s)=>{if(!("speechSynthesis"in window)){s(new Error("Speech synthesis no estÃ¡ soportado"));return}speechSynthesis.cancel();const o=new SpeechSynthesisUtterance(r.text);this.currentUtterance=o;const u=speechSynthesis.getVoices().find(l=>l.lang.startsWith("es")||l.name.toLowerCase().includes("spanish")||l.name.toLowerCase().includes("espaÃ±ol"));u&&(o.voice=u),o.rate=.9,o.pitch=1,o.volume=.8,o.onstart=()=>{var l;console.log(`TTS: Reproduciendo - ${r.agentName}`),(l=r.onStart)==null||l.call(r)},o.onend=()=>{console.log(`TTS: Completado - ${r.agentName}`),this.currentUtterance=null,n()},o.onerror=l=>{console.error("TTS: Error en utterance:",l),this.currentUtterance=null,s(new Error(`Error de speech synthesis: ${l.error}`))},speechSynthesis.speak(o)})}stop(){speechSynthesis.cancel(),this.queue=[],this.isPlaying=!1,this.currentUtterance=null,console.log("TTS: Detenido y cola limpiada")}pause(){this.isPlaying&&speechSynthesis.pause()}resume(){this.isPlaying&&speechSynthesis.resume()}getStatus(){return{isEnabled:this.isEnabled,isPlaying:this.isPlaying,queueLength:this.queue.length,currentItem:this.queue[0]||null}}clearQueue(){this.queue=[],console.log("TTS: Cola limpiada")}reset(){speechSynthesis.cancel(),this.queue=[],this.isPlaying=!1,this.currentUtterance=null,console.log("TTS: Estado completamente reseteado")}}const P=new Le;function Me({enabled:x,responseAgentsResults:r,directAgentsResults:n={},agents:s,isRunning:o=!1}){const t=p.useRef({}),u=p.useRef(new Set);p.useEffect(()=>{P.setEnabled(x)},[x]),p.useEffect(()=>{o&&(u.current.clear(),t.current={},P.reset(),console.log("TTS: Estados reseteados para nuevo workflow"))},[o]),p.useEffect(()=>{if(!x)return;const f={...r,...n};Object.entries(f).forEach(([b,C])=>{const g=t.current[b],N=!g||JSON.stringify(g)!==JSON.stringify(C),i=C==null?void 0:C.error,m=!u.current.has(b);if(N&&!i&&m){const j=s.find(E=>E.id===b),k=j?j.name:`Agente ${b}`,w=R.formatAgentResult(C);w&&w!=="Sin resultado"&&(console.log(`TTS: Agregando resultado de ${k} a la cola`),P.addToQueue({text:w,agentName:k,onStart:()=>{console.log(`TTS: Iniciando lectura de ${k}`)},onEnd:()=>{console.log(`TTS: Completada lectura de ${k}`),u.current.add(b)},onError:E=>{console.error(`TTS: Error leyendo ${k}:`,E),u.current.add(b)}}))}}),t.current={...f}},[r,n,s,x]),p.useEffect(()=>{x||(u.current.clear(),t.current={},P.reset())},[x]),p.useEffect(()=>{Object.keys(r).length===0&&Object.keys(n).length===0&&(u.current.clear(),t.current={})},[r,n]);const l=p.useCallback((f,b)=>{if(!x)return;const C=s.find(i=>i.id===f),g=C?C.name:`Agente ${f}`,N=R.formatAgentResult(b);N&&N!=="Sin resultado"&&P.addToQueue({text:N,agentName:g,onStart:()=>console.log(`TTS: Lectura manual iniciada - ${g}`),onEnd:()=>console.log(`TTS: Lectura manual completada - ${g}`),onError:i=>console.error(`TTS: Error en lectura manual - ${g}:`,i)})},[x,s]),c=p.useCallback(()=>{P.stop(),u.current.clear()},[]),a=p.useCallback(()=>{P.pause()},[]),d=p.useCallback(()=>{P.resume()},[]),v=p.useCallback(()=>{P.clearQueue()},[]),h=p.useCallback(()=>P.getStatus(),[]);return{speakAgentResult:l,stopTTS:c,pauseTTS:a,resumeTTS:d,clearTTSQueue:v,getTTSStatus:h}}function Ae({onFilesSelect:x,maxFiles:r,currentFileCount:n,isProcessing:s,disabled:o=!1}){const t=p.useRef(null),[u,l]=p.useState(!1),c=Math.max(0,r-n),a=c>0&&!o&&!s,d=p.useCallback(m=>{const j=Array.from(m),k=[],w=[];if(j.forEach(E=>{const L=te.validateImageFile(E);L.valid?k.push(E):w.push(`${E.name}: ${L.error}`)}),w.length>0&&alert(`Algunos archivos no son vÃ¡lidos:
${w.join(`
`)}`),k.length>0){const E=k.slice(0,c);x(E),E.length<k.length&&alert(`Se seleccionaron ${E.length} de ${k.length} archivos vÃ¡lidos debido al lÃ­mite de ${r} imÃ¡genes.`)}},[x,c,r]),v=p.useCallback(m=>{m.target.files&&m.target.files.length>0&&d(m.target.files),m.target.value=""},[d]),h=p.useCallback(m=>{if(m.preventDefault(),m.stopPropagation(),l(!1),!a)return;const j=m.dataTransfer.files;j&&j.length>0&&d(j)},[d,a]),f=p.useCallback(m=>{m.preventDefault(),m.stopPropagation()},[]),b=p.useCallback(m=>{m.preventDefault(),m.stopPropagation(),a&&l(!0)},[a]),C=p.useCallback(m=>{m.preventDefault(),m.stopPropagation(),l(!1)},[]),g=p.useCallback(()=>{a&&t.current&&t.current.click()},[a]),N=()=>s?"Procesando...":o?"Deshabilitado":c===0?`MÃ¡ximo ${r} imÃ¡genes alcanzado`:`Selecciona hasta ${c} imagen${c!==1?"es":""} mÃ¡s`,i=()=>s?"text-blue-600":o||c===0?"text-gray-500":"text-gray-700";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:"Subir MÃºltiples ImÃ¡genes"}),e.jsxs("div",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:[n,"/",r," imÃ¡genes"]})]}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-all duration-200 ${a?u?"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 cursor-pointer":"border-gray-300 dark:border-gray-600 cursor-not-allowed opacity-50"}`,onDrop:h,onDragOver:f,onDragEnter:b,onDragLeave:C,onClick:g,children:[e.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${a?"bg-blue-100 dark:bg-blue-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx("svg",{className:`w-8 h-8 ${a?"text-blue-600 dark:text-blue-400":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 12l3 3m0 0l3-3m-3 3V9"})})}),e.jsx("p",{className:"text-lg font-medium mb-2",style:{color:a?"var(--color-text-primary)":"var(--color-text-secondary)"},children:u?"Suelta las imÃ¡genes aquÃ­":"Arrastra imÃ¡genes aquÃ­ o haz clic para seleccionar"}),e.jsx("p",{className:`text-sm mb-4 ${i()}`,children:N()}),e.jsx("p",{className:"text-xs mb-4",style:{color:"var(--color-text-secondary)"},children:"Soporta JPG, PNG, GIF, BMP, WebP y PDF (mÃ¡ximo 10MB por archivo)"}),e.jsx("button",{className:`px-6 py-2 rounded-lg transition-colors duration-200 ${a?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,disabled:!a,type:"button",children:s?"Procesando...":"Seleccionar Archivos"})]}),n>0&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"text-sm text-green-800 dark:text-green-200 font-medium",children:[n," imagen",n!==1?"es":""," seleccionada",n!==1?"s":""]})]})}),e.jsx("input",{ref:t,type:"file",accept:"image/*,.pdf",multiple:!0,onChange:v,className:"hidden",disabled:!a})]})}function Pe({onImagesCapture:x,maxFiles:r,currentFileCount:n,isProcessing:s,disabled:o=!1}){const t=p.useRef(null),[u,l]=p.useState(null),[c,a]=p.useState(!1),[d,v]=p.useState([]),{settings:h}=oe(),f={width:h.videoConstraints.width,height:h.videoConstraints.height,facingMode:h.videoConstraints.facingMode},b=Math.max(0,r-n),C=b>0&&!o&&!s&&!c,g=p.useCallback(async()=>{if(!(!t.current||!C)){a(!0),l(null);try{await new Promise(k=>setTimeout(k,h.focusDelay*1e3));const j=t.current.getScreenshot({width:h.videoConstraints.width,height:h.videoConstraints.height});if(j){const w=await(await fetch(j)).blob(),E=new File([w],`camera-capture-${Date.now()}.${h.screenshotFormat.split("/")[1]}`,{type:h.screenshotFormat}),L=[...d,E];v(L),L.length>=b&&(x(L),v([]))}}catch(j){l("Error al capturar la imagen"),console.error("Error capturing image:",j)}finally{a(!1)}}},[h,C,d,b,x]),N=p.useCallback(()=>{d.length>0&&(x(d),v([]))},[d,x]),i=p.useCallback(()=>{v([])},[]),m=o||s||c;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:"Capturar con CÃ¡mara"}),e.jsxs("div",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:[n+d.length,"/",r," imÃ¡genes"]})]}),u&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 rounded-md",children:u}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{ref:t,audio:!1,videoConstraints:f,className:`w-full h-auto rounded-lg ${m?"opacity-50":""}`,style:{maxHeight:"60vh"},onUserMediaError:j=>{l("Error al acceder a la cÃ¡mara. Verifica los permisos."),console.error("Webcam error:",j)}}),(c||s)&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-2"}),e.jsx("p",{children:c?"Enfocando...":"Procesando..."})]})})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:g,disabled:!C,className:`flex-1 px-6 py-3 rounded-lg font-medium transition-colors duration-200 ${C?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,children:c?"Enfocando...":s?"Procesando...":"Capturar Foto"}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,disabled:s,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",children:["Procesar ",d.length," foto",d.length!==1?"s":""]}),e.jsx("button",{onClick:i,disabled:s,className:"px-4 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",children:"Limpiar"})]})]}),d.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L3.354 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsxs("span",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:[d.length," foto",d.length!==1?"s":""," capturada",d.length!==1?"s":""," pendiente",d.length!==1?"s":""," de procesar"]})]}),e.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:'Haz clic en "Procesar" para agregar a la lista de imÃ¡genes o "Capturar Foto" para tomar mÃ¡s.'})]}),e.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsxs("div",{children:["ResoluciÃ³n: ",h.videoConstraints.width,"x",h.videoConstraints.height]}),e.jsxs("div",{children:["CÃ¡mara: ",h.videoConstraints.facingMode==="environment"?"Trasera":"Frontal"]}),e.jsxs("div",{children:["Formato: ",h.screenshotFormat]}),e.jsxs("div",{children:["Calidad: ",h.screenshotQuality]}),e.jsxs("div",{children:["Delay: ",h.focusDelay,"s"]})]})})]})}function H({label:x,selectedAgentId:r,selectedAgentIds:n=[],onAgentSelect:s,onAgentsSelect:o,multiple:t=!1,disabled:u=!1,placeholder:l="Selecciona un agente...",helpText:c,required:a=!1}){var C;const{agents:d,isLoading:v}=z(),h=g=>{s&&s(g)},f=(g,N)=>{o&&o(N?[...n,g]:n.filter(i=>i!==g))},b=()=>{var g;return t?n.map(N=>{var i;return(i=d.find(m=>m.id===N))==null?void 0:i.name}).filter(Boolean).join(", "):((g=d.find(N=>N.id===r))==null?void 0:g.name)||""};return v?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",style:{color:"var(--color-text-primary)"},children:[x," ",a&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700",children:e.jsx("span",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Cargando agentes..."})})]}):d.length===0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",style:{color:"var(--color-text-primary)"},children:[x," ",a&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700",children:e.jsx("span",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"No hay agentes configurados"})}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Ve a ConfiguraciÃ³n para agregar agentes de Flowise"})]}):t?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",style:{color:"var(--color-text-primary)"},children:[x," ",a&&e.jsx("span",{className:"text-red-500",children:"*"})]}),n.length>0&&e.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:[e.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200 font-medium mb-1",children:[n.length," agente",n.length!==1?"s":""," seleccionado",n.length!==1?"s":"",":"]}),e.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:b()})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2",children:d.map(g=>{const N=n.includes(g.id);return e.jsxs("label",{className:`flex items-start space-x-3 p-2 rounded cursor-pointer transition-colors ${u?"opacity-50 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("input",{type:"checkbox",checked:N,onChange:i=>f(g.id,i.target.checked),disabled:u,className:"mt-0.5 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:g.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:g.url})]})]},g.id)})}),c&&e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:c})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",style:{color:"var(--color-text-primary)"},children:[x," ",a&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r,onChange:g=>h(g.target.value),disabled:u,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white ${u?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:l}),d.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]}),r&&e.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:[e.jsx("div",{className:"text-xs text-green-800 dark:text-green-200 font-medium",children:"Agente seleccionado:"}),e.jsx("div",{className:"text-xs text-green-700 dark:text-green-300",children:b()}),e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 truncate mt-1",children:(C=d.find(g=>g.id===r))==null?void 0:C.url})]}),c&&e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:c})]})}function Oe({images:x,workflowSteps:r,compiledOCRText:n,questionCompilerResult:s,responseAgentsResults:o,directAgentsResults:t={},isRunning:u,enableTTS:l=!1,onSpeakAgentResult:c,onStopTTS:a,onPauseTTS:d,onResumeTTS:v,onClearTTSQueue:h,getTTSStatus:f}){const{agents:b}=z(),C=i=>{switch(i){case"pending":return e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"â³"})});case"processing":return e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsxs("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})});case"completed":return e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})});case"error":return e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}},g=i=>{switch(i){case"pending":return"â³";case"processing":return"ðŸ”„";case"completed":return"âœ…";case"error":return"âŒ"}},N=(i,m)=>i?`${(((m||new Date).getTime()-i.getTime())/1e3).toFixed(1)}s`:"";return e.jsxs("div",{className:"space-y-6",children:[x.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Estado de las ImÃ¡genes"}),e.jsx("div",{className:"space-y-3",children:x.map((i,m)=>{var j;return e.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg",style:{backgroundColor:"var(--color-surface)"},children:[e.jsx("span",{className:"text-lg",children:g(i.status)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:["Imagen #",m+1,": ",i.name]}),e.jsxs("span",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:[(i.size/1024/1024).toFixed(2)," MB"]})]}),i.status==="completed"&&i.ocrResult&&e.jsxs("div",{className:"mt-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-xs",children:[e.jsx("div",{className:"font-medium text-green-800 dark:text-green-200 mb-1",children:"Resultado OCR:"}),e.jsx("div",{className:"text-green-700 dark:text-green-300 max-h-20 overflow-y-auto",children:R.formatOCRResult(i.ocrResult)})]}),i.status==="error"&&((j=i.ocrResult)==null?void 0:j.error)&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded text-xs",children:[e.jsx("div",{className:"font-medium text-red-800 dark:text-red-200 mb-1",children:"Error:"}),e.jsx("div",{className:"text-red-700 dark:text-red-300",children:i.ocrResult.error})]})]})]},i.id)})})]}),r.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Progreso del Workflow"}),e.jsx("div",{className:"space-y-4",children:r.map((i,m)=>e.jsxs("div",{className:"flex items-start space-x-4",children:[C(i.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:i.name}),i.startTime&&e.jsx("span",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:N(i.startTime,i.endTime)})]}),i.status==="error"&&i.error&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md",children:[e.jsx("div",{className:"text-sm text-red-800 dark:text-red-200 font-medium",children:"Error:"}),e.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:i.error})]}),i.status==="completed"&&i.result&&e.jsx("div",{className:"mt-2 text-xs",style:{color:"var(--color-text-secondary)"},children:"âœ“ Completado exitosamente"})]}),m<r.length-1&&e.jsx("div",{className:"absolute left-4 top-8 w-px h-6 bg-gray-300 dark:bg-gray-600",style:{marginTop:"2rem"}})]},i.id))})]}),n&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Texto OCR Compilado"}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap overflow-x-auto",style:{color:"var(--color-text-primary)"},children:n})})]}),s&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Resultado del Agente Compilador"}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap overflow-x-auto text-blue-800 dark:text-blue-200",children:R.formatAgentResult(s)})})]}),Object.keys(o).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:"Resultados de Agentes de Respuesta"}),l&&e.jsx("div",{className:"flex items-center space-x-2",children:f&&(()=>{const i=f();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:i.isPlaying?"Reproduciendo...":i.queueLength>0?`En cola: ${i.queueLength}`:"TTS listo"}),e.jsxs("div",{className:"flex space-x-1",children:[i.isPlaying?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Pausar TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:v,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Reanudar TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h1m4 0h1m-6-8h8a2 2 0 012 2v8a2 2 0 01-2 2H8a2 2 0 01-2-2V6a2 2 0 012-2z"})})})]}):e.jsx("button",{onClick:d,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Pausar TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:a,className:"p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-200",title:"Detener TTS",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 10h6v4H9z"})]})}),e.jsx("button",{onClick:h,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Limpiar cola TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})()})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(o).map(([i,m])=>{const j=b.find(w=>w.id===i),k=j?j.name:`Agente ${i}`;return e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-purple-800 dark:text-purple-200",children:k}),l&&c&&e.jsx("button",{onClick:()=>c(i,m),className:"p-1 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-200",title:"Leer respuesta con TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 4.663 12 5.109 12 6v12c0 .891-1.077 1.337-1.707.707L5.586 15z"})})})]}),j&&e.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 mb-2 truncate",children:j.url}),e.jsx("pre",{className:"text-sm whitespace-pre-wrap overflow-x-auto text-purple-700 dark:text-purple-300",children:R.formatAgentResult(m)})]},i)})})]}),Object.keys(t).length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:"Resultados de Agentes Directos"}),l&&e.jsx("div",{className:"flex items-center space-x-2",children:f&&(()=>{const i=f();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:i.isPlaying?"Reproduciendo...":i.queueLength>0?`En cola: ${i.queueLength}`:"TTS listo"}),e.jsxs("div",{className:"flex space-x-1",children:[i.isPlaying?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Pausar TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:v,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Reanudar TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h1m4 0h1m-6-8h8a2 2 0 012 2v8a2 2 0 01-2 2H8a2 2 0 01-2-2V6a2 2 0 012-2z"})})})]}):e.jsx("button",{onClick:d,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Pausar TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:a,className:"p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-200",title:"Detener TTS",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 10h6v4H9z"})]})}),e.jsx("button",{onClick:h,className:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Limpiar cola TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})()})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(t).map(([i,m])=>{const j=b.find(w=>w.id===i),k=j?j.name:`Agente ${i}`;return e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:k}),l&&c&&e.jsx("button",{onClick:()=>c(i,m),className:"p-1 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200",title:"Leer respuesta con TTS",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 4.663 12 5.109 12 6v12c0 .891-1.077 1.337-1.707.707L5.586 15z"})})})]}),j&&e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-2 truncate",children:j.url}),e.jsx("pre",{className:"text-sm whitespace-pre-wrap overflow-x-auto text-blue-700 dark:text-blue-300",children:R.formatAgentResult(m)})]},i)})})]}),u&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Ejecutando workflow..."})]})})]})}const ae=()=>typeof window<"u"&&window.location.pathname.includes("/react-mathpix-flowise")?"/react-mathpix-flowise":"",U=()=>{try{const r=`${ae()}/sounds/click.mp3`;console.log("Reproduciendo sonido de click desde:",r);const n=new Audio(r);n.volume=.5,n.play().catch(s=>{console.log("No se pudo reproducir el sonido de click:",s)})}catch(x){console.log("Error al reproducir sonido de click:",x)}},V=x=>{try{const n=`${ae()}/sounds/${x}`;console.log("Reproduciendo sonido de hover desde:",n);const s=new Audio(n);return s.volume=.3,s.loop=!0,s.play().catch(o=>{console.log("No se pudo reproducir el sonido de hover:",o)}),s}catch(r){return console.log("Error al reproducir sonido de hover:",r),null}},Q=x=>{if(x)try{x.pause(),x.currentTime=0}catch(r){console.log("Error al detener sonido de hover:",r)}};function Re({imagesCount:x,maxImages:r,isRunning:n,canRunWorkflow:s,onTakePhoto:o,onRunWorkflow:t,onReset:u}){const{settings:l}=oe(),{uiSettings:c}=ne(),a=p.useRef(null),d=p.useRef(null),v=p.useRef(null),h=p.useRef(null),f=x<r&&!n,b=p.useCallback(async()=>{if(!(!f||!a.current)){U();try{await new Promise(i=>setTimeout(i,l.focusDelay*1e3));const N=a.current.getScreenshot({width:l.videoConstraints.width,height:l.videoConstraints.height});if(N){const m=await(await fetch(N)).blob(),j=new File([m],`camera-capture-${Date.now()}.${l.screenshotFormat.split("/")[1]}`,{type:l.screenshotFormat});o(j)}}catch(N){console.error("Error en captura automÃ¡tica:",N)}}},[l,f,o]),C=p.useCallback(()=>{s&&(U(),t())},[s,t]),g=p.useCallback(()=>{U(),u()},[u]);return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @keyframes fastBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
          }
          .hover-fast-blink:hover {
            animation: fastBlink 0.3s infinite;
          }
        `}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[!c.compactMode&&e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"âš¡ Atajos de EjecuciÃ³n"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("button",{onClick:b,onMouseEnter:()=>{f&&(d.current=V("tap.wav"))},onMouseLeave:()=>{Q(d.current),d.current=null},disabled:!f,className:`px-4 py-6 rounded-lg font-medium transition-all duration-100 flex items-center justify-center space-x-2 hover-fast-blink ${f?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"Tomar Foto"})]}),e.jsxs("button",{onClick:C,onMouseEnter:()=>{s&&(v.current=V("woow.wav"))},onMouseLeave:()=>{Q(v.current),v.current=null},disabled:!s,className:`px-4 py-6 rounded-lg font-medium transition-all duration-100 flex items-center justify-center space-x-2 hover-fast-blink ${s?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("span",{children:"Procesar y Limpiar"}),x>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-white/20 rounded-full text-xs font-bold",children:x})]})]}),e.jsxs("button",{onClick:g,onMouseEnter:()=>{h.current=V("corazon.wav")},onMouseLeave:()=>{Q(h.current),h.current=null},className:"w-full px-4 py-6 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-100 flex items-center justify-center space-x-2 hover-fast-blink",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:n?"Cancelar Workflow":"Reiniciar"})]}),e.jsx("div",{className:"mt-3 text-xs",style:{color:"var(--color-text-secondary)"},children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["ImÃ¡genes: ",x,"/",r]}),e.jsxs("span",{children:["Estado: ",n?"Ejecutando...":"Listo"]})]})}),e.jsx("div",{className:"hidden",children:e.jsx(se,{ref:a,audio:!1,videoConstraints:{width:l.videoConstraints.width,height:l.videoConstraints.height,facingMode:l.videoConstraints.facingMode},onUserMediaError:N=>{console.error("Webcam error:",N)}})})]})]})}function We({responseAgentsResults:x,directAgentsResults:r={}}){const{agents:n}=z(),{uiSettings:s}=ne(),o=a=>{if(!a||a.error)return(a==null?void 0:a.error)||"Sin resultado";if(a.data){if(a.data.lectura)return a.data.lectura;if(typeof a.data=="string")return a.data;if(typeof a.data=="object"){const d=h=>{if(h.lectura&&typeof h.lectura=="string")return h.lectura;for(const f in h)if(typeof h[f]=="object"&&h[f]!==null){const b=d(h[f]);if(b)return b}return null},v=d(a.data);if(v)return v}}return a.lectura&&typeof a.lectura=="string"?a.lectura:'Campo "lectura" no encontrado en la respuesta'},t=Object.keys(x).length>0,u=Object.keys(r).length>0,l=Object.values(x).some(a=>a&&!a.error&&o(a)!=="Sin resultado"),c=Object.values(r).some(a=>a&&!a.error&&o(a)!=="Sin resultado");return(!t||!l)&&(!u||!c)?null:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[!s.compactMode&&e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"ðŸ“‹ Resumen de Resultados"}),e.jsxs("div",{className:"space-y-6",children:[l&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium mb-3",style:{color:"var(--color-text-primary)"},children:"ðŸ“„ Resultados Mathpix OCR"}),e.jsx("div",{className:"space-y-4",children:Object.entries(x).map(([a,d])=>{const v=n.find(b=>b.id===a),h=v?v.name:`Agente ${a}`,f=o(d);return!f||f==="Sin resultado"?null:e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:h}),e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Lectura"})]}),e.jsx("div",{className:"text-sm text-green-700 dark:text-green-300 whitespace-pre-wrap",children:f})]},a)})})]}),c&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium mb-3",style:{color:"var(--color-text-primary)"},children:"ðŸš€ Resultados Agentes Directos"}),e.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([a,d])=>{const v=n.find(b=>b.id===a),h=v?v.name:`Agente ${a}`,f=o(d);return!f||f==="Sin resultado"?null:e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:h}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Lectura"})]}),e.jsx("div",{className:"text-sm text-blue-700 dark:text-blue-300 whitespace-pre-wrap",children:f})]},a)})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-xs text-blue-700 dark:text-blue-300",children:'Mostrando solo el campo "lectura" de las respuestas de los agentes'})]})})]})}function Je({}){return[{title:"Multi-OCR Workflow - Procesamiento Avanzado"},{name:"description",content:"Workflow avanzado para procesar mÃºltiples imÃ¡genes con OCR y agentes de IA"}]}const Ge=ke(function(){var Z;const{config:r,updateConfig:n,saveConfig:s,images:o,addImages:t,removeImage:u,clearImages:l,updateImageStatus:c,workflowSteps:a,updateWorkflowStep:d,initializeWorkflowSteps:v,resetWorkflow:h,compiledOCRText:f,setCompiledOCRText:b,questionCompilerResult:C,setQuestionCompilerResult:g,responseAgentsResults:N,setResponseAgentResult:i,directAgentsResults:m,setDirectAgentResult:j,clearResults:k,isRunning:w,setIsRunning:E,cancelWorkflow:L,resetImages:W,resetAll:J}=Ce(),{agents:M}=z(),{settings:O}=Se(),{prompts:D}=Te(),{speakAgentResult:ie,stopTTS:de,pauseTTS:le,resumeTTS:ce,clearTTSQueue:ue,getTTSStatus:xe}=Me({enabled:r.enableTTS,responseAgentsResults:N,directAgentsResults:m,agents:M,isRunning:w}),[G,me]=p.useState(!1),he=y=>{const T={...r,questionCompilerAgentId:y};n(T),s(T)},ge=y=>{const T={...r,responseAgentIds:y};n(T),s(T)},pe=y=>{const T={...r,enableTTS:y};n(T),s(T)},fe=y=>{const T={...r,directAgentsIds:y};n(T),s(T)},ye=y=>{const T={...r,selectedPromptId:y};n(T),s(T)},K=p.useCallback(()=>{const y=[];return(!O.appId||!O.appKey)&&y.push("ConfiguraciÃ³n de Mathpix incompleta"),r.questionCompilerAgentId||y.push("Agente compilador de preguntas no seleccionado"),r.responseAgentIds.length===0&&y.push("No hay agentes de respuesta seleccionados"),r.directAgentsIds.length>0&&!r.selectedPromptId&&y.push("Debe seleccionar un prompt para los agentes directos"),o.length===0&&y.push("No hay imÃ¡genes para procesar"),me(y.length>0),y},[O,r,o]),F=p.useCallback(async()=>{const y=K();if(y.length>0){alert(`No se puede ejecutar el workflow:
${y.join(`
`)}`);return}E(!0),k(),v();try{const T=M.find(S=>S.id===r.questionCompilerAgentId),ve=M.filter(S=>r.responseAgentIds.includes(S.id)),_=M.filter(S=>r.directAgentsIds.includes(S.id)),ee=D.find(S=>S.id===r.selectedPromptId);if(!T)throw new Error("Agente compilador no encontrado");const re={onImageOCRStart:S=>{c(S,"processing")},onImageOCRComplete:(S,A)=>{c(S,"completed",A)},onImageOCRError:(S,A)=>{c(S,"error",{status:0,data:null,error:A})},onStepStart:S=>{d(S,{status:"processing",startTime:new Date})},onStepComplete:(S,A)=>{d(S,{status:"completed",endTime:new Date,result:A})},onStepError:(S,A)=>{d(S,{status:"error",endTime:new Date,error:A})}},B=[];B.push(R.processWorkflow(o,T,ve,{appId:O.appId,appKey:O.appKey,includeMath:O.includeMath,outputFormats:O.outputFormats},re)),_.length>0&&ee&&B.push(R.processDirectAgents(o,_,ee,re));const q=await Promise.all(B),$=q[0];if($.success?(b($.compiledOCRText),g($.questionCompilerResult),Object.entries($.responseAgentsResults).forEach(([S,A])=>{i(S,A)})):alert(`Error en el workflow Mathpix OCR: ${$.error}`),q.length>1){const S=q[1];S.success?Object.entries(S.directAgentsResults).forEach(([A,be])=>{j(A,be)}):alert(`Error en el workflow Directo a Agentes: ${S.error}`)}}catch(T){console.error("Error executing workflow:",T),alert(`Error inesperado: ${T instanceof Error?T.message:"Error desconocido"}`)}finally{E(!1)}},[K,M,r,o,O,k,v,c,d,b,g,i]),je=p.useCallback(async()=>{await F(),setTimeout(()=>{W()},2e3)},[F,W]),X=()=>{w?L():W()},Y=!w&&!G&&o.length>0&&!!r.questionCompilerAgentId&&r.responseAgentIds.length>0&&(r.directAgentsIds.length===0||!!r.selectedPromptId);return e.jsxs("div",{className:"min-h-screen pb-20",style:{backgroundColor:"var(--color-background)"},children:[e.jsx(Ee,{title:"Multi-OCR Workflow",description:"Procesamiento avanzado con Mathpix OCR y envÃ­o directo a agentes en paralelo",icon:"âš¡"}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx(Re,{imagesCount:o.length,maxImages:r.maxImages,isRunning:w,canRunWorkflow:Y,onTakePhoto:y=>t([y]),onRunWorkflow:je,onReset:X}),e.jsx(We,{responseAgentsResults:N,directAgentsResults:m}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"ConfiguraciÃ³n del Workflow"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(H,{label:"Agente Compilador de Preguntas",selectedAgentId:r.questionCompilerAgentId,onAgentSelect:he,placeholder:"Selecciona el agente compilador...",helpText:"Este agente procesarÃ¡ el texto OCR compilado y generarÃ¡ una pregunta.",required:!0,disabled:w}),e.jsx(H,{label:"Agentes de Respuesta",selectedAgentId:"",selectedAgentIds:r.responseAgentIds,onAgentsSelect:ge,multiple:!0,helpText:"Estos agentes procesarÃ¡n la respuesta del agente compilador en paralelo.",required:!0,disabled:w})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:"Text-to-Speech (TTS)"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-secondary)"},children:"Leer automÃ¡ticamente las respuestas de los agentes cuando terminen de procesar"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.enableTTS,onChange:y=>pe(y.target.checked),disabled:w,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:"Habilitar TTS"})]})]}),r.enableTTS&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"ðŸ’¡ InformaciÃ³n sobre TTS:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"â€¢ Las respuestas se leerÃ¡n automÃ¡ticamente cuando cada agente termine"}),e.jsx("li",{children:"â€¢ Las lecturas se ejecutan en secuencia (una despuÃ©s de la otra)"}),e.jsx("li",{children:"â€¢ Se detecta automÃ¡ticamente el idioma espaÃ±ol si estÃ¡ disponible"}),e.jsx("li",{children:"â€¢ Puedes pausar/reanudar desde los controles de TTS"})]})]})]})})]}),M.length>0&&D.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Workflow Directo a Agentes (Opcional)"}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--color-text-secondary)"},children:"EnvÃ­a las imÃ¡genes directamente a agentes seleccionados con un prompt especÃ­fico, ejecutÃ¡ndose en paralelo con el workflow Mathpix OCR."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(H,{label:"Agentes Directos",selectedAgentId:"",selectedAgentIds:r.directAgentsIds,onAgentsSelect:fe,multiple:!0,helpText:"Estos agentes recibirÃ¡n las imÃ¡genes directamente con el prompt seleccionado.",disabled:w}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Prompt para Agentes Directos"}),e.jsxs("select",{value:r.selectedPromptId,onChange:y=>ye(y.target.value),disabled:w,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"Selecciona un prompt..."}),D.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]}),r.selectedPromptId&&e.jsx("div",{className:"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Prompt seleccionado:"})," ",(Z=D.find(y=>y.id===r.selectedPromptId))==null?void 0:Z.content]})})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:G?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L3.354 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"ConfiguraciÃ³n incompleta"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm text-green-700 dark:text-green-300",children:"ConfiguraciÃ³n completa"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:["MÃ¡ximo ",r.maxImages," imÃ¡genes"]}),e.jsx("button",{onClick:()=>{window.confirm("Â¿EstÃ¡s seguro de que quieres borrar TODOS los resultados y empezar desde cero?")&&J()},className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded transition-colors duration-200",disabled:w,children:"Borrar Todo"})]})]})]}),e.jsx(Ae,{onFilesSelect:t,maxFiles:r.maxImages,currentFileCount:o.length,isProcessing:w,disabled:w}),e.jsx(Pe,{onImagesCapture:t,maxFiles:r.maxImages,currentFileCount:o.length,isProcessing:w,disabled:w}),o.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:["ImÃ¡genes Seleccionadas (",o.length,")"]}),e.jsx("button",{onClick:l,disabled:w,className:"px-3 py-1 text-sm bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white rounded-md transition-colors duration-200",children:"Limpiar Todo"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map((y,T)=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:["#",T+1]}),e.jsx("button",{onClick:()=>u(y.id),disabled:w,className:"text-red-600 hover:text-red-700 disabled:text-gray-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 truncate mb-1",children:y.name}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(y.size/1024/1024).toFixed(2)," MB"]})]},y.id))})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:F,disabled:!Y,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200 flex items-center justify-center",children:w?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Ejecutando Workflow..."]}):"Ejecutar Workflow"}),e.jsx("button",{onClick:X,disabled:w,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",children:"Reiniciar"})]}),e.jsx(Oe,{images:o,workflowSteps:a,compiledOCRText:f,questionCompilerResult:C,responseAgentsResults:N,directAgentsResults:m,isRunning:w,enableTTS:r.enableTTS,onSpeakAgentResult:ie,onStopTTS:de,onPauseTTS:le,onResumeTTS:ce,onClearTTSQueue:ue,getTTSStatus:xe}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-800 dark:text-blue-200 mb-3",children:"Â¿CÃ³mo funciona el Multi-OCR Workflow?"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium text-blue-800 dark:text-blue-200 mb-3",children:"ðŸ“„ Workflow Mathpix OCR"}),e.jsxs("div",{className:"space-y-3 text-sm text-blue-700 dark:text-blue-300",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 dark:text-blue-200",children:"1"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Captura de ImÃ¡genes:"})," Sube archivos desde tu dispositivo o captura fotos con la cÃ¡mara (hasta ",r.maxImages," imÃ¡genes)."]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 dark:text-blue-200",children:"2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Procesamiento OCR:"})," Las imÃ¡genes se procesan en paralelo con Mathpix OCR para extraer texto y fÃ³rmulas."]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 dark:text-blue-200",children:"3"}),e.jsxs("div",{children:[e.jsx("strong",{children:"CompilaciÃ³n:"}),' Los resultados OCR se compilan en un texto estructurado con formato "OCR #1 ',"{","texto","}",' FIN OCR #1".']})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 dark:text-blue-200",children:"4"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Agente Compilador:"})," El texto compilado se envÃ­a al agente compilador que genera una pregunta o consulta procesada."]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 dark:text-blue-200",children:"5"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Agentes de Respuesta:"})," La respuesta del compilador se envÃ­a en paralelo a mÃºltiples agentes especializados."]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-md font-medium text-blue-800 dark:text-blue-200 mb-3",children:"ðŸš€ Workflow Directo a Agentes (Opcional)"}),e.jsxs("div",{className:"space-y-3 text-sm text-blue-700 dark:text-blue-300",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center text-xs font-bold text-green-800 dark:text-green-200",children:"1"}),e.jsxs("div",{children:[e.jsx("strong",{children:"SelecciÃ³n de Agentes:"})," Elige uno o mÃ¡s agentes que recibirÃ¡n las imÃ¡genes directamente."]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center text-xs font-bold text-green-800 dark:text-green-200",children:"2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"SelecciÃ³n de Prompt:"})," Elige un prompt que se aplicarÃ¡ a todos los agentes seleccionados."]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center text-xs font-bold text-green-800 dark:text-green-200",children:"3"}),e.jsxs("div",{children:[e.jsx("strong",{children:"EnvÃ­o Directo:"})," Las imÃ¡genes se envÃ­an directamente a cada agente con el prompt seleccionado, ejecutÃ¡ndose en paralelo con el workflow Mathpix OCR."]})]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-100 dark:bg-blue-800/30 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"ðŸ’¡ Consejos para mejores resultados:"}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Usa la cÃ¡mara para capturar pantallas de notebook con tu celular"}),e.jsx("li",{children:"â€¢ Configura la resoluciÃ³n y delay de enfoque en ConfiguraciÃ³n"}),e.jsx("li",{children:"â€¢ AsegÃºrate de que el texto sea legible y estÃ© bien iluminado"}),e.jsx("li",{children:"â€¢ Puedes combinar archivos subidos con fotos capturadas"})]})]})]})]})]})});export{Ge as default,Je as meta};
