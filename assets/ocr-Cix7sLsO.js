import{a as n,p as e,w as f}from"./chunk-B7RQU5TL-xj-QjgGV.js";import{M as b}from"./mathpixService-BVSjE40i.js";import{u as v}from"./MathpixSettingsContext-C5kfmVKl.js";import{W as j}from"./react-webcam-Cv0vQhem.js";import{u as N}from"./CameraSettingsContext-BDn7_6_x.js";function k({onFileSelect:o,isProcessing:s,disabled:t=!1}){const l=n.useRef(null),x=n.useCallback(r=>{var u;const i=(u=r.target.files)==null?void 0:u[0];i&&o(i)},[o]),d=n.useCallback(r=>{if(r.preventDefault(),r.stopPropagation(),t||s)return;const i=r.dataTransfer.files[0];i&&o(i)},[o,t,s]),c=n.useCallback(r=>{r.preventDefault(),r.stopPropagation()},[]),m=n.useCallback(()=>{!t&&!s&&l.current&&l.current.click()},[t,s]),a=t||s;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Subir Imagen"}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors duration-200 ${a?"border-gray-300 dark:border-gray-600 cursor-not-allowed opacity-50":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 cursor-pointer"}`,onDrop:d,onDragOver:c,onClick:m,children:[e.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${a?"bg-gray-100 dark:bg-gray-700":"bg-blue-100 dark:bg-blue-900/30"}`,children:e.jsx("svg",{className:`w-8 h-8 ${a?"text-gray-400":"text-blue-600 dark:text-blue-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsx("p",{className:`text-lg font-medium mb-2 ${a?"text-gray-400":""}`,style:{color:a?"var(--color-text-secondary)":"var(--color-text-primary)"},children:s?"Procesando...":"Arrastra una imagen aquí o haz clic para seleccionar"}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--color-text-secondary)"},children:"Soporta JPG, PNG, GIF, BMP, WebP y PDF (máximo 10MB)"}),e.jsx("button",{className:`px-6 py-2 rounded-lg transition-colors duration-200 ${a?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,disabled:a,type:"button",children:s?"Procesando...":"Seleccionar Archivo"})]}),e.jsx("input",{ref:l,type:"file",accept:"image/*,.pdf",onChange:x,className:"hidden",disabled:a})]})}function w({onImageCapture:o,isProcessing:s,disabled:t=!1}){const l=n.useRef(null),[x,d]=n.useState(null),[c,m]=n.useState(!1),{settings:a}=N(),r={width:a.videoConstraints.width,height:a.videoConstraints.height,facingMode:a.videoConstraints.facingMode},i=n.useCallback(async()=>{if(!(!l.current||t||s||c)){m(!0),d(null);try{await new Promise(p=>setTimeout(p,a.focusDelay*1e3));const h=l.current.getScreenshot({width:a.videoConstraints.width,height:a.videoConstraints.height});if(h){const y=await(await fetch(h)).blob(),g=new File([y],`camera-capture-${Date.now()}.${a.screenshotFormat.split("/")[1]}`,{type:a.screenshotFormat});o(g)}}catch(h){d("Error al capturar la imagen"),console.error("Error capturing image:",h)}finally{m(!1)}}},[a,o,t,s,c]),u=t||s||c;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Capturar con Cámara"}),x&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 rounded-md",children:x}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{ref:l,audio:!1,videoConstraints:r,className:`w-full h-auto rounded-lg ${u?"opacity-50":""}`,style:{maxHeight:"60vh"},onUserMediaError:h=>{d("Error al acceder a la cámara. Verifica los permisos."),console.error("Webcam error:",h)}}),(c||s)&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-2"}),e.jsx("p",{children:c?"Enfocando...":"Procesando..."})]})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:i,disabled:u,className:`px-6 py-3 rounded-lg font-medium transition-colors duration-200 ${u?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:c?"Enfocando...":s?"Procesando...":"Capturar y Procesar"})}),e.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsxs("div",{children:["Resolución: ",a.videoConstraints.width,"x",a.videoConstraints.height]}),e.jsxs("div",{children:["Cámara: ",a.videoConstraints.facingMode==="environment"?"Trasera":"Frontal"]}),e.jsxs("div",{children:["Formato: ",a.screenshotFormat]}),e.jsxs("div",{children:["Calidad: ",a.screenshotQuality]}),e.jsxs("div",{children:["Delay: ",a.focusDelay,"s"]})]})})]})}function C({result:o,isProcessing:s,selectedFile:t,error:l,onClearResult:x,onClearError:d}){const c=r=>r>=200&&r<300?"text-green-600 dark:text-green-400":r>=400&&r<500?"text-yellow-600 dark:text-yellow-400":r>=500?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400",m=r=>r>=200&&r<300?"✅":r>=400&&r<500?"⚠️":r>=500?"❌":"❓",a=r=>typeof r=="string"?r:typeof r=="object"&&r!==null?JSON.stringify(r,null,2):String(r);return s?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Procesando Imagen"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center animate-spin",style:{backgroundColor:"var(--color-accent)"},children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-lg font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Analizando imagen con Mathpix..."}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:t==null?void 0:t.name})]})]}):l?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:"Error en el Procesamiento"}),e.jsx("button",{onClick:d,className:"px-3 py-1 text-sm bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200",children:"Cerrar"})]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5",children:e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:l})]})]})})]}):o?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-medium",style:{color:"var(--color-text-primary)"},children:"Resultados del OCR"}),e.jsx("button",{onClick:x,className:"px-3 py-1 text-sm bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200",children:"Limpiar"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:"Status Code:"}),e.jsxs("span",{className:`text-sm font-mono px-2 py-1 rounded ${c(o.status)}`,children:[m(o.status)," ",o.status]})]})}),o.request&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Información de la Request:"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-3",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"URL:"}),e.jsxs("span",{className:"text-xs font-mono text-blue-600 dark:text-blue-400 break-all",children:[o.request.method," ",o.request.url]})]})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 block mb-1",children:"Headers:"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-2",children:e.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap",style:{color:"var(--color-text-secondary)"},children:JSON.stringify(o.request.headers,null,2)})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 block mb-1",children:"Parámetros:"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-2",children:e.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap",style:{color:"var(--color-text-secondary)"},children:JSON.stringify(o.request.parameters,null,2)})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:"Respuesta de la API:"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 overflow-auto max-h-96",children:e.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap",style:{color:"var(--color-text-secondary)"},children:a(o.data)})})]}),t&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm",style:{color:"var(--color-text-secondary)"},children:[e.jsx("span",{children:"Archivo procesado:"}),e.jsx("span",{className:"font-medium",children:t.name}),e.jsxs("span",{children:["(",(t.size/1024).toFixed(1)," KB)"]})]})})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Resultados del OCR"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center bg-gray-100 dark:bg-gray-700",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--color-text-secondary)"},children:"Los resultados del reconocimiento aparecerán aquí"}),e.jsx("div",{className:"text-xs px-3 py-1 rounded-full inline-block bg-gray-100 dark:bg-gray-700",style:{color:"var(--color-text-secondary)"},children:"Sube una imagen para empezar"})]})]})}function I({}){return[{title:"OCR - Mathpix Explorer"},{name:"description",content:"Explorador de la API de OCR de Mathpix para reconocimiento de texto y fórmulas matemáticas"}]}const D=f(function(){const{settings:s}=v(),[t,l]=n.useState(!1),[x,d]=n.useState(null),[c,m]=n.useState(null),[a,r]=n.useState(null),i=n.useCallback(async p=>{const y=b.validateImageFile(p);if(!y.valid){r(y.error||"Archivo inválido"),l(!1);return}if(!s.appId||!s.appKey){r("Configuración de Mathpix incompleta. Ve a Configuración para agregar tus credenciales."),l(!1);return}l(!0),r(null),m(p),d(null);try{const g=await b.processImage(p,{appId:s.appId,appKey:s.appKey,includeMath:s.includeMath,outputFormats:s.outputFormats});d(g),l(!1),r(g.error||null)}catch(g){l(!1),r(g instanceof Error?g.message:"Error desconocido")}},[s]),u=n.useCallback(()=>{d(null),m(null),r(null)},[]),h=n.useCallback(()=>{r(null)},[]);return e.jsxs("div",{className:"min-h-screen pb-20",style:{backgroundColor:"var(--color-background)"},children:[e.jsxs("div",{className:"shadow-sm border-b px-4 py-4",style:{backgroundColor:"var(--color-surface)",borderColor:"var(--color-border)"},children:[e.jsx("h1",{className:"text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:"🔍 OCR Explorer"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--color-text-secondary)"},children:"Reconocimiento de texto y fórmulas matemáticas con Mathpix API"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx(k,{onFileSelect:i,isProcessing:t}),e.jsx(w,{onImageCapture:i,isProcessing:t}),e.jsx(C,{result:x,isProcessing:t,selectedFile:c,error:a,onClearResult:u,onClearError:h}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",style:{color:"var(--color-text-primary)"},children:"Características de Mathpix OCR"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg",style:{backgroundColor:"var(--color-surface)"},children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--color-accent)"},children:e.jsx("span",{className:"text-white text-sm",children:"📝"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",style:{color:"var(--color-text-primary)"},children:"Reconocimiento de Texto"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Extrae texto de imágenes con alta precisión"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg",style:{backgroundColor:"var(--color-surface)"},children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--color-accent)"},children:e.jsx("span",{className:"text-white text-sm",children:"🧮"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",style:{color:"var(--color-text-primary)"},children:"Fórmulas Matemáticas"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Convierte ecuaciones a LaTeX y MathML"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg",style:{backgroundColor:"var(--color-surface)"},children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--color-accent)"},children:e.jsx("span",{className:"text-white text-sm",children:"📊"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",style:{color:"var(--color-text-primary)"},children:"Múltiples Formatos"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Texto, LaTeX, MathML y más"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg",style:{backgroundColor:"var(--color-surface)"},children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--color-accent)"},children:e.jsx("span",{className:"text-white text-sm",children:"⚡"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",style:{color:"var(--color-text-primary)"},children:"Procesamiento Rápido"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Resultados en segundos"})]})]})]})]})]})]})});export{D as default,I as meta};
